<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Proyecto</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
<section id="fondo">
    <div id="indicearriba">
        <p>
            <a href="#1">PREPARACIÓN DE RASPBERRY PI</a> |
            <a href="#2">Instalación de Apache Server</a> |
            <a href="#3">Instalación MYSQL</a> <br>
            <a href="#4">Base de datos</a>  |
            <a href="#6">Alojar pagina web en Apache</a> |
            <a href="#7">Estimación de costes</a>
        </p>
    </div>
    <nav id="menu">
        <div id="menutexto">
            <h2>ÍNDICE</h2>
            <ol>
                <li><a href="#1">PREPARACIÓN DE RASPBERRY PI</a></li>
                <li><a href="#2">Instalación de Apache Server</a></li>
                <li><a href="#3">Instalación MYSQL</a></li>
                <li><a href="#4">Base de datos</a></li>
                <li><a href="#6">Alojar pagina web en Apache</a></li>
                <li><a href="#7">Estimación de costes</a></li>
            </ol>
            <p>El proyecto consiste en mediante un <strong>Raspberry Pi 2</strong>
                crear un <strong>servidor Apache</strong> en el que vamos a alojar nuestra página web.
                Además, instalaremos un <strong>servidor MYSQL</strong> en el que alojaremos una
                base de datos basada en el colegio.</p>
        </div>
        <a id="logoenlace" href="http://www.centrodonbosco.es/web/index.php/component/content/article/14-sample-data-articles/100-servicio-plataforma-educamos" target="_blank">
            <span id="logo"></span></a>
    </nav>
    <div id="contenido">
        <h1>PROYECTO</h1>
        <h2>César Pérez Molaguero  |  Victor Pérez Pedrosa | Pedro Garrido Requejo</h2>
        <div id="texto">

            <h3>OBJETIVO</h3>

            <p>El objetivo del proyecto consiste en mediante una <strong>Raspberry Pi 2</strong>, que debemos conectar a ella
                por SSH (por lo que no tendremos interfaze gráfica), crear un <strong>servidor Apache</strong>
                en el que vamos a alojar nuestra página web que será la memoria del proyecto.
                Además, instalaremos un <strong>servidor MYSQL</strong> en el que alojaremos una
                base de datos basada en el colegio. Esta base de datos contemplará los profesores, los alumnos, sus horarios y notas, y el lugar
                donde se imparte cada clase.</p>

            <h3 id="1">1.PREPARACIÓN DE RASPBERRY PI 2</h3>

            <p>El primer paso es encontrar nuestra Raspberry en la red, para ello la Raspberry
                y nuestro ordenador deben estar conectados en el mismo segmento de red.
                Para facilitar este proyecto utilizaremos un router en el que la parte LAN estén el router y la Raspberry.
                Este será el esquema de red que montaremos.</p>
            <figure>
                <img src="img/1/diagrama1.PNG" alt="Diagrama de red inicial">
                <figcaption>Fig.1 Diagrama de red inicial</figcaption>
            </figure>
            <p>Ahora para comprobar que tenemos conexión con la Raspberry, desde el PC haremos un ping a la Raspberry.</p>
            <figure>
                <img src="img/1/conexionconRasp.PNG" alt="Prueba conexión con Raspberry">
                <figcaption>Fig.2 Prueba de conexión con Raspberry</figcaption>
            </figure>
            <p>Para conectar con la Raspberry de manera remota utilizaremos el comando <strong>ssh pi@192.168.0.191</strong>
                y la contraseña por defecto es <strong>raspberry</strong>.</p>
            <p>El siguiente paso sería cambiar la configuración de red de la Raspberry para estar en el segmento de red del colegio
                y así tener salida a Internet. Para ello utilizaremos el editor de texto <strong>nano</strong> y modificaremos el archivo
                <strong>/etc/network/interfaces</strong>, aplicaremos una configuración de red estática.</p>
            <figure>
                <img src="img/1/configuracionestaticaRasp.PNG" alt="Configuración estática Raspberry">
                <figcaption>Fig 3. Configuración de red estática Raspberry</figcaption>
            </figure>
            <p>Ahora para que se applique la configuración debemos reiniciar la Raspberry con el comando <strong>sudo reboot.</strong><br>
                Después debemos conectar el PC a la red del colegio para que la Raspberry y el PC estén en el mismo segmento de red.</p>
            <figure>
                <img src="img/1/diagrama2.PNG" alt="Diagrama de red 2">
                <figcaption>Fig 4. Diagrama de red 2</figcaption>
            </figure>
            <p>Comprobamos la conexión con el ordenador (<strong>ping 192.168.41.240/24</strong>)
                y además probamos si la Raspberry tiene salida a Internet (<strong>ping www.as.com</strong>).</p>
            <figure>
                <img src="img/1/ping-as.PNG" alt="Ping www.as.com">
                <figcaption>Fig 5. Ping www.as.com</figcaption>
            </figure>


            <h3 id="2">2. Instalación de Apache Server</h3>

            <p>El primer paso para instalar Apache será actualizar la Raspberry para tener la última versión de Apache.
                Entraremos en root con <strong>sudo -i</strong>y utilizaremos el comando <strong>apt-get update</strong></p>
            <p>Después para tener los paquetes actualizados utilizaremos el comando <strong>apt-get upgrade</strong></p>
            <p>Ahora empezaremos la instalación de Apache mediante el comando <strong>apt-get install apache2</strong>
                y despúes reiniciaremos el resvicio con <strong>service apache2 restart</strong></p>
            <p>Para comprobar que funciona podremos en un navegador la dirección IP de la Raspberry y debería salir la
                siguiente página:</p>
            <figure>
                <img src="img/1/pagina-apache.PNG" alt="Página por defecto de Apache">
                <figcaption>Fig 6. Página por defecto de Apache </figcaption>
            </figure>


            <h3 id="3">3. Instalación MYSQL</h3>

            <p>Para la instalación de MySQL Server debemos seguir en root y ejecutar los comandos
                <strong>apt-get install mysql-server</strong>, después para que lea el lenguaje Php debemos
                ejecutar <strong>apt-get install php7.0</strong>. <br>
                Y para que se pueda comunicar con MYSQL ejecutamos <strong>apt-get install php7.0-mysql</strong>.
                Después restauramos el servicio de
                Apache para que se apliquen los cambios.</p>
            <p>El siguiente paso será comprobar que todo funciona correctamente, para ello
                crearemos una pequeña página en el directorio <strong>/var/www/html/</strong>
                que muestre la configuración de PHP.
                Utilizaremos el comando <strong>nano /var/www/html/inex2.php</strong> y entraremos
                en el editor de texto Nano donde crearemos la página. Este será el código que pondremos.
            </p>
            <figure>
                <img src="img/1/conf-php.PNG" alt="Página configuración PHP">
                <figcaption>Fig 6. Página para probar que PHP funciona. </figcaption>
            </figure>
            <p>Ahora abrimos el navegador y ponemos <strong>192.168.41.202/index2.php</strong></p>
            <figure>
                <img src="img/1/pag-conf-php.PNG" alt="Página que muestra la configuración PHP">
                <figcaption>Fig 7. Página que muestra la configuración PHP. </figcaption>
            </figure>

            <h4>Seguridad de MYSQL</h4>
            <p>Para una mayor seguridad solo permitiremos las conexiones por <strong>localhost</strong>, que están controladas por el
                <strong>puerto 3306</strong>. Este deberá aparecer cerrado para conexciones de fuera, y abierto para localhost.</p>
            <p>Utizaremos el <strong>mysql_secure_installation</strong>, habrá una paso en el que te pregunta "¿Quieres permitir conexiones remotas?"
                debemos darele a no. Además de hacer lo mencionado anteriormente aquí podremos cambiar la contraseña del root, borrar usuarios
                y bases de datos por defecto...</p>
            <p>Una vez instalado las pruebas que debemos realizar son:</p>
            <p>-Escaneo de puertos mediante nmap con una conexión remota. Como vemos en la imagen el puerto 3306 está cerrado.<br>
                Comando: <strong>nmap 192.168.41.202 -p 3306</strong></p>
            <figure>
                <img src="img/1/nmap-fuera.PNG" alt="Escaneo del puerto 3306 en remoto">
                <figcaption>Fig 8. Escaneo del puerto 3306 en remoto. </figcaption>
            </figure>
            <p>-Entramos a la Raspberry para estar en localhost, y hacemos un nmap de las conexiones localhost.
                Como vemos en la imagen el puerto 3306 está abierto. <br>
                Comando: <strong>nmap localhost</strong></p>
            <figure>
                <img src="img/1/nmap-localhost.PNG" alt="Escaneo nmap localhost">
                <figcaption>Fig 9. Escaneo nmap localhost. </figcaption>
            </figure>
            <p>-Entrar a MySQL desde localhost. Debemos poder entrar. <br>
                Comando: <strong>mysql -h localhost -u root -p</strong></p>
            <figure>
                <img src="img/1/mysql-localhost.PNG" alt="Entrar a MySQL desde localhost">
                <figcaption>Fig 10. Entrar a MySQL desde localhost. </figcaption>
            </figure>

            <h4>PHPMyAdmin</h4>
            <p>Para poder manejar MySQL desde una interfaz gráfica debemos instalar PHPMyAdmin</p>
            <p>Los pasos para ello son los siguientes: <br>
            -Instalamos el paquete desde root. <strong>apt-get install phpmyadmin</strong> <br>
            -Ahora debemos añadir "Include /etc/phpmyadmin/apache.conf" al final del archivo <strong>/etc/apache2/apache2.conf</strong><br>
            -Reiniciamos Apache. <strong>service apache2 restart</strong> <br>
            -Entramos a mysql como root. <strong>mysql -u root -p</strong> <br>
            -Usar mysql. <strong>use mysql;</strong> <br>
            -<strong>update user ser plugin '' where User='root';</strong> <br>
            -<strong>flush privileges;</strong> <br>
            Ahora ya tendríamos todo instalado, para entrar debemos ir al navegardor y escribir <strong>192.1168.41.202/phpmyadmin</strong>
                Nos saldrá la siguiente página a la que accederemos con el usuario root y la contraseña que le hallamos puesto en mysql_secure_installation.<br>
            </p>
            <figure>
                <img src="img/1/phpmyadmin.PNG" alt="Interfaz de PHPMyAdmin">
                <figcaption>Fig 11. Interfaz de PHPMyAdmin. </figcaption>
            </figure>

            <h3 id="4">4. Base de datos</h3>
            <h4>CREACIÓN DE UN USUARIOS</h4>
            <p>Primero vamos a crear un usuario que solo tenga acceso a la base de datos que vamos a crear que se llamará "colegio".
                Para ello entraremos a mysql desde localhost con el usuario root (<strong>mysql -h localhost -u root -p</strong>).<br>
                Después cearemos un usuario llamado "user" con contraseña "kebab123"
                (<strong>CREATE USER 'user'@'localhost' IDENTIFIED BY 'kebab123';</strong>)<br>
                Ahora le daremos privilegios solo para la base de datos del colegio.
                (<strong>GRANT ALL PRIVILEGES ON colegio. * TO 'user'@'localhost';</strong>)<br>
                Y refrescamos los privilegios. (<strong>flush privileges;</strong>)</p>
            <figure>
                <img src="img/1/usuario-colegio-mysql.PNG" alt="Creación de usuario para la base de datos colegio">
                <figcaption>Fig 12. Creación de usuario para la base de datos colegio. </figcaption>
            </figure>


            </p>
            <h4>Modelo Entidad/Relación</h4>
            <p>Vamos a crear la base de datos del  ciclo de ASIR. En esta base de datos quedará reflejado: <br>
                -Nombre y Apellidos de los profesores y profesoras. <br>
                -Nombre de los módulos que imparten tanto en 1º como en 2º. <br>
                -Horario de los módulos. <br>
                -Descripción de las aulas. <br>
                -Tareas de cada módulo. <br>
                -Nombre y Apellidos de los Alumnos de 1º y de 2º. <br>
            <figure>
                <img src="img/1/Entidadrelacion.PNG" alt="Modelo Entidad/Relación" style="width: 100%;">
                <figcaption>Fig 13. Modelo Entidad/Relación. </figcaption>
            </figure>
            <h4>Modelo relacional</h4>
            <figure>
                <img src="img/1/RELACIONAL.PNG" alt="Modelo relacional" style="width: 100%;">
                <figcaption>Fig 14. Modelo Relacional. </figcaption>
            </figure>
            <h4>Implementación de las tablas</h4>
            <p>Ahora debemos implementar el modelo relacional en MySQL, para facilitar este paso utilizaremos la herramienta PHPMyAdmin.</p>

            <h3 id="6">6. Alojar pagina web en Apache</h3>
            <h3 id="7">7. Estimación de costes</h3>
            
        </div>
    </div>

</section>
</body>
</html>